when hackers corral infected computers into a botnet they take special care to ensure they don’t lose control of the server that sends commands and updates to the compromised devices the precautions are designed to thwart security defenders who routinely dismantle botnets by taking over the commandandcontrol server that administers them in a process known as sinkholingrecently a botnet that researchers have been following for about two years began using a new way to prevent commandandcontrol server takedowns by camouflaging one of its ip addresses in the bitcoin blockchainimpossible to block censor or take downwhen things are working normally infected machines will report to the hardwired control server to receive instructions and malware updates in the event that server gets sinkholed however the botnet will find the ip address for the backup server encoded in the bitcoin blockchain a decentralized ledger that tracks all transactions made using the digital currencyby having a server the botnet can fall back on the operators prevent the infected systems from being orphaned storing the address in the blockchain ensures it can never be changed deleted or blocked as is sometimes the case when hackers use more traditional backup methods“what’s different here is that typically in those cases there’s some centralized authority that’s sitting on the top” said chad seaman a researcher at akamai the content delivery network that made the discovery “in this case they’re utilizing a decentralized system you can’t take it down you can’t censor it it’s there”converting satoshi valuesan internet protocol address is a numerical label that maps the network location of devices connected to the internet an ip version  address is a  number that’s stored in four octets the current ip address for arstechnicacom for instance is  with each octet separated by a dot  addresses are out of the scope of this postthe botnet observed by akamai stored the backup server ip address in the two most recent transactions posted to  a bitcoin wallet address selected by the operators the most recent transaction provided the third and fourth octets while the second most recent transaction provided the first and second octetsadvertisementthe octets are encoded in the transaction as a “satoshi value” which is one hundred millionth of a bitcoin  btc and currently the smallest unit of the bitcoin currency that can be recorded on the blockchain to decode the ip address the botnet malware converts each satoshi value into a hexadecimal representation the representation is then broken up into two bytes with each one being converted to its corresponding integerthe image below depicts a portion of a bash script that the malware uses in the conversion process aa shows the bitcoin wallet address chosen by the operators bb contains the endpoint that looks up the two most recent transactions and cc shows the commands that convert the satoshi values to the ip address of the backup serverif the script was converted into python code it would look like thisthe satoshi values in the two most recent wallet transactions are  and  when converted the ip address is in a blog post being published on tuesday akamai researchers explain it this wayknowing this let’s look at the values of these transactions and convert them into ip address octets the most recent transaction has a value of  satoshis converting this integer value into its hexadecimal representation results in the value  taking the first byte  and converting it into an integer results in the number —this will be the  octet of our final ip address taking the second byte  and converting it into an integer results in the number  which will become the  octet in our final ip address the same process is done with the second transaction to obtain the first and second octets of the  ip address in this case the value of the second transaction is  satoshis this value converted to its hexadecimal representation results in the hex value of  the first byte  and the second byte  are then converted into integers this results in the decimal numbers  and  which are the second and first octets of the  ip address respectively putting the four generated octets together in their respective order results in the final  ip address of here’s a representation of the conversion processadvertisementnot entirely newwhile akamai researchers say they have never before seen a botnet in the wild using a decentralized blockchain to store server addresses they were able to find this research that demonstrates a fully functional command server built on top of the blockchain for the ethereum cryptocurrency“by leveraging the blockchain as intermediate the infrastructure is virtually unstoppable dealing with most of the shortcoming of regular malicious infrastructures” wrote omer zoha the researcher who devised the proofofconcept control server lookupcriminals already had other covert means for infected bots to locate command servers for example vpnfilter the malware that russian governmentbacked hackers used to infect  home and small office routers in  relied on gps values stored in images stored on photobucketcom to locate servers where laterstage payloads were available in the event the images were removed vpnfilter used a backup method that was embedded in a server at toknowallcommalware from turla another hacking group backed by the russian government located its control server using comments posted in britney spears’ official instagram accountthe botnet akamai analyzed uses the computing resources and electricity supply of infected machines to mine the monero cryptocurrency in  researchers from trend micro published this detailed writeup on its capabilities akamai estimates that at current monero prices the botnet has mined about  worth of the digital coincheap to disrupt costly to restorein theory blockchainbased obfuscation of control server addresses can make takedowns much harder in the case here disruptions are simple since sending a single satoshi to the attacker’s wallet will change the ip address that the botnet malware calculateswith a satoshi valued at  cent at the time of research anyway  would allow  disruption transactions to be placed in the wallet the attackers meanwhile would have to deposit  satoshis or about  to recover control of their botnetthere’s yet another way to defeat the blockchainbased resilience measure the fallback measure activates only when the primary control server fails to establish a connection or it returns an http status code other than  or “if sinkhole operators successfully sinkhole the primary infrastructure for these infections they only need to respond with a  status code for all incoming requests to prevent the existing infection from failing over to using the btc backup ip address” akamai researcher evyatar saias explained in tuesday’s post“there are improvements that can be made which we’ve excluded from this writeup to avoid providing pointers and feedback to the botnet developers” saias added “adoption of this technique could be very problematic and it will likely gain popularity in the near future”post updated to correct amount of monero mined and to correct spelling of saias