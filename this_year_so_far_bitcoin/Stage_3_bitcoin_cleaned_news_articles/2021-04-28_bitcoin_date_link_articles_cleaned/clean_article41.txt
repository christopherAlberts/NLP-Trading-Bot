this post originally appeared on medium as part of a threepart series on bitcoin smart contracts and we republished with permission from xiaohui liu read part  herefair coin toss without depositin the previous article we generalize bitcoin smart contracts to include optional offchain validation part besides the conventional onchain part consisting of bitcoin script we applied the concept on a fully onchain coin toss by disincentivizing parties from aborting using depositin this article we implement an alternative contract for achieving fair coin toss as developed in reference¹ it acts as another example of how to design such hybrid smart contracts with onchain and offchain parts smart contract is defined as a protocol where distrusting parties can transact per their mutual agreement securely without a trusted third party security depends on the specific contract and can usually include properties such as  honest parties who follow the contractprotocol should never lose their money  dishonest parties who deviate must be detected and can optionally be penalized financiallyfair coin toss without depositthe new contract consists of the following lock stepsalice and bob exchanges public keys locktime t and hash of secret numbersnonces with each other bob creates  with txid of  he also creates  he gives it to alice he does not sign it yet otherwise alice would know his secret alice signs  and returns it to bob bob signs and adds his secret now  is complete he creates  and hands it to alice alice signs it and returns to bob who broadcasts  and  alice now knows bob’s secret in  alice sends her secret to bob and whoever wins take the bet as in the original coin toss contract if she does not share her secret before t bob can sign and broadcast  to take the betin each step after  each party validates transactions offchain locally and aborts if validation fails these validations include signature t secret hash and txid match the contract is secure because bob must reveal his secret to create  alice must also do so otherwise bob will win by broadcasting the hashlock contract in  is shown belowthe cointoss contract in  is the same as before except that a function forfeit is added secure multiparty computations on bitcoin · marcin andrychowicz stefan dziembowski l mazurek  ieee symposium on security and privacynew to bitcoin check out coingeek’s bitcoin for beginners section the ultimate resource guide to learn more about bitcoin—as originally envisioned by satoshi nakamoto—and blockchain